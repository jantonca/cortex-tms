---
import { Link2, Share2 } from '@lucide/astro'

interface Props {
  url: string
  title: string
  description?: string
}

const { url, title, description } = Astro.props

// Encode for URLs
const encodedUrl = encodeURIComponent(url)
const encodedTitle = encodeURIComponent(title)
const encodedDescription = description ? encodeURIComponent(description) : ''

// Share URLs
const twitterUrl = `https://twitter.com/intent/tweet?url=${encodedUrl}&text=${encodedTitle}`
const hackerNewsUrl = `https://news.ycombinator.com/submitlink?u=${encodedUrl}&t=${encodedTitle}`
const redditUrl = `https://www.reddit.com/submit?url=${encodedUrl}&title=${encodedTitle}`
---

<div class='social-share'>
  <span class='share-label'>Share this article:</span>
  <button class='share-link copy-btn' data-url={url} title='Copy link'>
    <Link2 size={20} />
  </button>
  <span class='separator'>·</span>
  <a
    href={twitterUrl}
    target='_blank'
    rel='noopener noreferrer'
    class='share-link twitter-link'
    title='Share on X'
  >
    <svg
      width='20'
      height='20'
      viewBox='0 0 24 24'
      fill='currentColor'
      xmlns='http://www.w3.org/2000/svg'
    >
      <path
        d='M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z'
      ></path>
    </svg>
  </a>
  <span class='separator'>·</span>
  <a
    href={hackerNewsUrl}
    target='_blank'
    rel='noopener noreferrer'
    class='share-link hn-link'
    title='Share on Hacker News'
  >
    <svg
      xmlns='http://www.w3.org/2000/svg'
      viewBox='0 0 16 16'
      fill='none'
      stroke='none'
      width='20'
      height='20'
    >
      <path
        fill='currentColor'
        fill-rule='evenodd'
        clip-rule='evenodd'
        d='M0 0H16V16H0V0ZM4.69024 3.8925L7.46363 9.0659V12.4258H8.53025V9.11913L11.3036 3.8925H10.1302L8.53025 7.14582C8.42355 7.30582 8.31694 7.46582 8.26363 7.62582C8.23286 7.74859 8.1845 7.83601 8.13883 7.91862C8.10515 7.97957 8.07286 8.0379 8.05024 8.10582C8.02355 8.07913 8.01017 8.03913 7.99686 7.99906C7.98355 7.95913 7.97024 7.91913 7.94355 7.89244C7.91686 7.83913 7.90348 7.79906 7.89017 7.75899C7.87686 7.71906 7.86355 7.67906 7.83694 7.62582V7.57251L7.78355 7.51913C7.76319 7.47841 7.75061 7.44546 7.73984 7.41731C7.72246 7.37171 7.70988 7.33877 7.67694 7.30582C7.62355 7.25251 7.57024 7.19913 7.57024 7.14582L5.97024 3.8925H4.69024Z'
      ></path>
    </svg>
  </a>
  <span class='separator'>·</span>
  <a
    href={redditUrl}
    target='_blank'
    rel='noopener noreferrer'
    class='share-link reddit-link'
    title='Share on Reddit'
  >
    <svg
      width='20'
      height='20'
      viewBox='0 0 24 24'
      fill='currentColor'
      xmlns='http://www.w3.org/2000/svg'
    >
      <path
        d='M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z'
      ></path>
    </svg>
  </a>
</div>

<script>
  // Copy to clipboard functionality
  document.addEventListener('DOMContentLoaded', () => {
    const copyButtons = document.querySelectorAll('.copy-btn')

    copyButtons.forEach((button) => {
      button.addEventListener('click', async () => {
        const url = button.getAttribute('data-url')
        if (!url) return

        try {
          await navigator.clipboard.writeText(url)

          // Visual feedback
          button.classList.add('copied')

          setTimeout(() => {
            button.classList.remove('copied')
          }, 2000)
        } catch (err) {
          console.error('Failed to copy:', err)
        }
      })
    })
  })
</script>

<style>
  .social-share {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.9375rem;
    color: var(--sl-color-gray-3);
    flex-wrap: wrap;
  }

  .share-label {
    font-weight: 600;
    color: var(--sl-color-gray-2);
  }

  .separator {
    color: var(--sl-color-gray-4);
    font-size: 1.5rem;
    line-height: 1;
    font-weight: 700;
  }

  .share-link {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    color: var(--sl-color-accent);
    text-decoration: none;
    cursor: pointer;
    transition: all 0.2s ease;
    background: none;
    border: none;
    padding: 0;
    font-size: 0.9375rem;
    font-family: inherit;
  }

  .share-link svg {
    flex-shrink: 0;
  }

  .share-link:hover {
    color: var(--sl-color-accent-high);
    transform: translateY(-2px);
  }

  .copy-btn.copied {
    color: rgb(34, 197, 94);
  }

  @media (max-width: 640px) {
    .social-share {
      font-size: 0.875rem;
    }

    .share-link {
      font-size: 0.875rem;
    }
  }
</style>
